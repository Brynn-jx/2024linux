3.0
改进协议,在发送完文件总长度后，直接发送内容

4.0
使用mmap零拷贝技术,之前需要用read从内核缓冲区读取到用户缓冲区，使用了mmap可以直接通过DMA映射到内存，然后再通过send发送给内核缓冲区详解见image1
使用mmap后省去了read的时间，直接建立文件和用户态空间buf的映射。详解见iamge2
如果mmap使用的是SHARED
5.0
使用 mmap 系统调用只能减少数据从磁盘文件的文件对象到用户态空间的拷贝，但是依然无
法避免从用户态到内核已连接套接字的拷贝（因为网络设备文件对象不支持 mmap ）。
sendfile 系统调用可以解决这个问题，它可以使数据直接在内核中传递而不需要经过用户
态空间，调用 sendfile 系统调用可以直接将磁盘文件的文件对象的数据直接传递给已连接
套接字文件对象，从而直接发送到网卡设备之上（在内核的底层实现中，实际上是让内核磁
盘文件缓冲区和网络缓冲区对应同一片物理内存）。
使用 sendfile 的时候要特别注意， out_fd 一般只能填写网络套接字的描述符，表示写入的
文件描述符， in_fd 一般是一个磁盘文件，表示读取的文件描述符。从上述的需求可以得
知， sendfile 只能用于发送文件方的零拷贝实现，无法用于接收方，并且发送文件的大小
上限是2GB。下面是使用 sendfile 的发送方的例子。
使用 sendfile 的时候要特别注意， out_fd 一般只能填写网络套接字的描述符，表示写入的
文件描述符， in_fd 一般是一个磁盘文件，表示读取的文件描述符。从上述的需求可以得
知， sendfile 只能用于发送文件方的零拷贝实现，无法用于接收方，并且发送文件的大小
上限是2GB。下面是使用 sendfile 的发送方的例子。
考虑到 sendfile 只能将数据从磁盘文件发送到网络设备中，那么接收方如何在避免使用
mmap 的情况下使用零拷贝技术呢？一种方式就是采用管道配合 splice 的做法。 splice 系
统调用可以直接将数据从内核管道文件缓冲区发送到另一个内核文件缓冲区，也可以反之，
将一个内核文件缓冲区的数据直接发送到内核管道缓冲区中。所以只需要在内核创建一个匿
名管道，这个管道用于本进程中，在磁盘文件和网络文件之间无拷贝地传递数据。